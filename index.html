<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>QR Scanner</title>

<!-- Telegram Web App -->
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<!-- QR Scanner -->
<script src="https://unpkg.com/html5-qrcode"></script>

<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body style="font-family:Arial;text-align:center;padding:20px">

<h2>üì∑ –°–∫–∞–Ω—É–≤–∞–Ω–Ω—è QR-–∫–æ–¥—É</h2>

<button id="scanBtn" style="font-size:18px;padding:10px 20px;">
  ‚ñ∂Ô∏è –ü–æ—á–∞—Ç–∏ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è
</button>

<div id="reader" style="margin-top:20px;"></div>
<p id="result">–û—á—ñ–∫—É—é —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è...</p>

<script>
let html5QrCode;

// üëâ –ö–Ω–æ–ø–∫–∞ —Å—Ç–∞—Ä—Ç—É
document.getElementById("scanBtn").addEventListener("click", startScan);

function startScan() {
  html5QrCode = new Html5Qrcode("reader");

  Html5Qrcode.getCameras().then(cameras => {
    if (!cameras || cameras.length === 0) {
      alert("–ö–∞–º–µ—Ä–∏ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ");
      return;
    }

    // üî¥ –ü–†–Ü–û–†–ò–¢–ï–¢: –∑–∞–¥–Ω—è –∫–∞–º–µ—Ä–∞
    let backCamera = cameras.find(cam =>
      cam.label.toLowerCase().includes("back") ||
      cam.label.toLowerCase().includes("rear")
    );

    const cameraId = backCamera
      ? backCamera.id
      : cameras[cameras.length - 1].id;

    html5QrCode.start(
      cameraId,
      {
        fps: 10,
        qrbox: 250
      },
      onScanSuccess,
      error => {}
    );
  });
}

// üëâ –ö–û–õ–ò QR –í–Ü–î–°–ö–ê–ù–û–í–ê–ù–û
function onScanSuccess(decodedText) {
  document.getElementById("result").innerText =
    "‚úÖ –í—ñ–¥—Å–∫–∞–Ω–æ–≤–∞–Ω–æ: " + decodedText;

  // –ó—É–ø–∏–Ω—è—î–º–æ –∫–∞–º–µ—Ä—É
  html5QrCode.stop().then(() => {

    // üöÄ –ù–ê–î–°–ò–õ–ê–Ñ–ú–û –í TELEGRAM
    if (window.Telegram && Telegram.WebApp) {
      Telegram.WebApp.sendData(decodedText);
      Telegram.WebApp.close();
    } else {
      alert("–¶–µ –Ω–µ Telegram Web App");
    }

  });
}
</script>

</body>
</html>





